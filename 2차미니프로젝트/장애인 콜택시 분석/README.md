# 도매인 이해

장애인분들이 가장 많이 사용하는 이동수단은 장애인 콜택시임 → 카카오 택시처럼 해당 택시만을 잡을 수 있는 어플이 존재함. BUT! 이게 문제임, 택시 수는 적은데 대기하는 인원이 너무 많아서 오래걸림

또한 장애인 택시는 일반 택시처럼 가장 가까운 곳의 택시가 배차되는 것이 아니라, 택시마다 순번이 있기 때문에 대기 시간이 오래걸림

택시 배차 후에 30분 이내에 탑승하는 비율이 30프로가 안됨.

너무 긴 대기 시간이 큰 문제라는 것

Target : 다음날의 평균대기시간. 기상 예보를 바탕으로 다음 날의 평균대기시간을 예측하자.

궁금한 점 : 택시를 호출했는데, 취소를 하면 그 때까지의 기간은 평균대기시간으로 포함하는가 ?

# 데이터 분석

- 학습 데이터
    - 2015.01 ~ 2022.09
- 테스트 데이터
    - 2022.10 ~ 2022.12
- 날씨 데이터는 실제 측정값이지만, 다음 날에 대한 예보 데이터로 간주
    - 예를 들어,
        - 2020-12-23 의 날씨 데이터는 전 날(12월22일) 날씨예보 데이터로 간주하여 분석을 수행
        - 2020-12-22일의 장애인 이동 데이터로 23일의 대기시간을 예측해야 하며, 이때 고려할 날씨데이터는 23일 데이터임
- 가설
    1. 중요하게 봐야할 데이터는 강수량임 - 강수량 상승 → 습도 증가, 일조량 감소, 기온 감소
    2. 평균대기시간이 증가한다는 것은 평소보다 (이용자 수/배차 수)의 비율이 증가한다는 것
        1. 비가 많이 올 때
        2. 엄청 추울 때
        3. 엄청 더울 때
- 모든 데이터에서 결측치가 존재하지 않음
- 데이터 상관관계
    - 나머지는 전부 당연한 이야기임(예: 평균 이동거리가 증가하면 평균 운임 요금이 증가한다.)
    - 평균 대기시간은 접수건과 꽤나 관련이 있고 나머지는 관련이 없어인다.
    - 따라서, 기상에 따른 접수건을 비교하는게 바람직해 보임
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/e81b6490-64f0-4868-94c8-f9c1978f04a3/f831a7b7-142d-4604-b672-a2df2092091e/Untitled.png)
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/e81b6490-64f0-4868-94c8-f9c1978f04a3/1431e7e3-4c06-419e-947c-b32dad66edea/Untitled.png)
    
- 요일별, 월별, 일별, 연간에 따라서 얼마나 탑승을 하는 지 분석
    - 일별 : 나머지는 비등비등하나, 31일이 특히나 이용 승객이 적음(31일이 있는 달이 적어서 그렇지 않나 추정)
    - 월별 : 7월과 11월달에 접수건 수가 많이 높음. 하지만, 평균 대기 시간의 경우, 5월달과 9~12월달이 높음
    - 요일별 : 주말과 평일의 운행 건수, 접수건, 탑승건이 2배 이상 차이가 남. 출퇴근 및 등하교의 목적이 큰 것으로 추정. 하지만, 평균 운행 대기 시간은 유사함 → 운행 건수와 관련이 있지 않을까?
    - 연도별 : 시간이 지날수록 운행 건수는 꾸준히 증가하나, 나머지는 그렇지 않음. 들쑥날쑥
- 비는 관계가 없어보인다.
    - 비가 오지 않는 날이 대부분여서 그런지, 비가 오는 날의 평균 대기 시간은 상당히 짧음
    - 하지만 평균 대기 시간의 이상치인 데이터들(매우 큰 시간)은 거의 다 비가 오는 날임
- target과 가장 상관관계가 높은 5개의 데이터는 'target', '7days', 'average_waiting_time', 'receipt_count', 'month’

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/e81b6490-64f0-4868-94c8-f9c1978f04a3/363c1b93-bfe0-4335-902e-a1734b8543ba/Untitled.png)

# 데이터 전처리

1. 결측치가 하나도 없는 데이터이기 때문에 보간을 신경쓸 필요가 없음
2. 사실상 금일 프로젝트는 이 단계가 그렇게 중요하지 않음

# 모델링

1. LinearRegression - MAE: 4.538145115806732, MAPE: 0.1138739603200688
2. Decision Tree - MAE: 8.528571428571428, MAPE: 0.2030604770319315
3. Random Forest - MAE: 4.595000000000002, MAPE: 0.11348153004606698

→ 가장 결과가 좋은 모델은 LinearRegression, 하지만 그래프 상에서는 Random Forest가 더 좋아보인다.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/e81b6490-64f0-4868-94c8-f9c1978f04a3/6700bd6b-9321-426c-bb39-c0482d1c35fd/Untitled.png)

# 팀원들의 인사이트

### 데이터

- 주말에 탑승객이 적다
- **강수량에 따른 평균대기시간의 차이와 탑승객의 차이는 없다.**
- 주말에 탑승객은 적은데, 이동거리는 길고 운행료도 비싸다.
- 일요일에 대기시간이 가장 짧다.
- 장애인 콜택시는 일반 택시처럼 가장 가까운 거리에 배치되지 않는다.
- 순번제이기 때문에 먼 거리의 택시가 배정받을 수 있어서 호출을 취소할 수 있다.
- 가을에 대기 시간이 길다.
- 공휴일에 평균승차거리가 높은 편이다.
- 차량운행을 많이 하면 평균대기시간이 짧을 거라고 생각하지만, 둘의 상관관계는 0에 가깝다.
- 차량별 접수 건수가 많을수록 평균대기시간이 길어진다.

### 모델링

- 가장 중요도가 높은 항목 : “7일간의 평균대기시간”(2위는 접수건)
- week, year, day 항목을 뺏을 때가 오히려 모델의 성능이 높았다. (MAE 0.3 감소)
    
    ![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/e81b6490-64f0-4868-94c8-f9c1978f04a3/3256b235-0788-49f5-9e72-7fab1b0603d1/Untitled.png)
    
- 그럼 왜 높은걸까?

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/e81b6490-64f0-4868-94c8-f9c1978f04a3/d7f16a7b-f621-46ee-a11b-2b4a382430ab/Untitled.png)

- 위의 사진을 보면 2018년의 값이 눈에 띌 정도로 높아짐. 저 달이 택시 파업이 있던 날임.
- 따라서 특정 사건에 관련된 변수가 많기 때문에 week, year, day와 같이 날짜를 신경쓰지 않는 것이 성능이 높은 것으로 추정
- 가장 성능이 좋은 모델은 LinearRegression

# 타팀 분석

온도와 습도를 통합하여 체감 온도(불쾌 지수)를 따로 분류하였다.

코로나가 유행이던 시기(2020~2022)를 따로 분류하였다.

장애인 콜택시의 이용목적은 주로 병원과 복지시설의 이동이다. 따라서, 병원이나 복지관이 휴무 시에는 수요가 감소한다. 

매년 4월 20일은 장애인의 날로 콜택시를 무료로 운행한다. → 주변 일자 대비 접수 건 및 대기시간 증가

기상 데이터와 Target간의 상관관계가 적기 때문에 기상 데이터의 변수를 단순화했음

내일 날짜가 공휴일인지 여부를 나타나게 함

pycaret(대부분의 모델을 자동으로 전처리하여 모델링하여 성능을 비교해주는 라이브러리)를 사용하여 모델 선정

수치형 데이터를 로그값을 씌어서 사용한 것이 성능이 더 높았음
