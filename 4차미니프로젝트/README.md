# 목표

현재 “쏘카”, “그린카”와 같이 차량 쉐어 서비스 사용량이 증가하고 있다.

대부분은 차량을 이용하기 전에 차량 외형을 촬영함으로써, 파손 여부를 확인하고 이를 회사로 전송한다.

하지만, 하루에 전송되는 차량 사진은 7~10만 개로 상당히 많아서 이를 하나하나 확인하기에는 어려움이 크다.

따라서, 이를 자동으로 분류하는 모델을 만들자

필자가 판단했을 때, 시간이 3시간 정도로 한정적이기 때문에 각 카테고리(일반 모델, 전이 모델) 별로 최고의 성능을 내는 모델을 설계하는 것은 어렵다고 판단했음.

→ 모두 간단한 구조로 설계를 하되, 상대적으로 간단한 구조와 복잡한 구조를 비교할 때 누가 더 성능이 좋은 지와 일반 모델과 전이 모델을 비교할 때 누가 더 성능이 좋은 지를 비교하기로 결정함

# 도매인 이해

데이터가 사진으로 시각 데이터만 존재하기 때문에 따로 신경쓸 요인은 없는 듯하다.

# 데이터 분석

- Normal Data(정상 차량)의 개수 : 302개
- Abnormal Data(파손 차량)의 개수 : 303개
- 파손 차량은 한눈에 봐도 상태가 좋지 않은 것을 육안으로 판단할 수 있음(변색, 파손, 스크래치 등)

# 데이터 전처리

1. Abnormal, Normal 데이터를 순서대로 한 데이터에 넣으면 Y 레이블의 값이 [0, 0, 0, 0, 1, 1, 1, 1]과 같은 형태로 같은 종류의 값이 모여있는 것을 알 수가 있음.
2. 따라서, 이는 학습에서 좋지 않은 영향을 줄 것으로 판단하여 X, Y 데이터끼리의 짝만 어긋나지 않게 Randomize화
3. cv2 라이브러리를 사용하여, Image path를 통해 사진을 가져오고 0~1 사이의 값으로 정규화
4. Train, Test 데이터를 9:1로 나누고, 나눈 Train 데이터에서 Train, Val 데이터를 다시 9:1로 나눠주었음.

# 모델링1

- 전이 학습을 사용하지 않고 Sequential한 모델을 총 3개 설계
- 3개의 모델 모두 EarlyStopping 적용
- 작은 파라미터부터 큰 파라미터 순으로 설계
- 결론 : 파라미터가 클수록 좋은 것은 아니다. 오히려 가장 작은 값이 정확도가 제일 높았다.
    1. 정확도 : 0.8852459016393442
    2. 정확도 : 0.7868852459016393
    3. 정확도 : 0.8360655737704918

# 모델링2

- 전이 학습과 Augmentation을 사용하였음
- **Inception V3** 모델을 사용함
- 정확도 : 0.7851239669421488
- 이전 설계한 모델에서 마지막 Dense Layer는 1개로 설정하였을 때의 결과와 2개로 설정하였을 때의 결과가 매우 다름
- 파손 차량의 유무를 판단하는 이진 분류이기 때문에 초기에는 Dense Layer를 1로 설정하였고 그 때의 정확도는 0.5245901639344263으로 매우 낮게 나왔음
- 허나, Dense Layer를 2로 설정하였을 때의 정확도는 0.7540983606557377로 매우 성능이 좋아진 것을 확인할 수가 있음
  
    → 검색 결과, 이는 데이터의 복잡성 때문일 확률이 있음. 데이터가 더 복잡하거나 클래스 간의 결정 경계가 모호한 경우, softmax를 사용하여 두 개의 클래스에 대한 확률을 모두 출력하는 것이 유용할 수 있음. 이는 이진 분류 뿐만 아니라 여러 개인 다중 클래스 분류 문제에 대해서도 softmax를 사용하여 다양한 클래스에 대한 확률을 출력할 수 있음.
    
- image_dataset_from_directory는 자동으로 데이터셋에서 train, validation 집합으로 나누어 데이터셋 객체를 반환해주는 라이브러리임. 따라서, test 데이터는 기존에 train_test_split으로 나눈 test 데이터를 똑같이 활용함.
- ImageDataGenerator를 통해 Data Augmentation을 해서 shape을 출력하면, 한 이미지에 (32, 256, 256, 3)이 출력되는 것을 확인할 수 있음. 이는 하나의 이미지가 증강을 통해 32개의 이미지가 생성된 것을 나타냄
- InceptionV3 모델을 전이 학습했을 때, train 데이터셋에서 정확도가 100으로 Overfitting이 발생함, 테스트 데이터의 정확도 결과는 78정도였음.

# 타팀 결과

- Sota라는 웹사이트에서 제공하는 상황별 모델들의 정확도를 바탕으로 상위 10개의 모델을 사용하였다. 그 결과, EfficientNetB0가 제일 성능이 높았음
- 다른 팀들도 데이터 전처리에 집중하는 것보다는 어떤 모델을 사용할지에 대해서 신경을 많이 썼음
